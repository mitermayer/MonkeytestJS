<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Monkeytestjs by TheMonkeys</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Monkeytestjs</h1>
        <p class="header">The Monkeys global acceptance tests and framework for pulling in page based tests written to work with QUnitRunner </p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/TheMonkeys/MonkeytestJS/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/TheMonkeys/MonkeytestJS/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/TheMonkeys/MonkeytestJS">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/TheMonkeys">TheMonkeys</a></p>


      </header>
      <section>
        <p><a href="https://travis-ci.org/TheMonkeys/MonkeytestJS"><img src="https://travis-ci.org/TheMonkeys/MonkeytestJS.png" alt="Build Status"></a></p>

<h1>
<a name="monkeytestjs" class="anchor" href="#monkeytestjs"><span class="octicon octicon-link"></span></a>MonkeytestJS</h1>

<h2>
<a name="getting-started" class="anchor" href="#getting-started"><span class="octicon octicon-link"></span></a>Getting Started</h2>

<p>The file <code>config.json</code> include the <strong>options</strong> for the runner:</p>

<div class="highlight"><pre><span class="p">{</span>
    <span class="s2">"envs"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"local"</span><span class="o">:</span> <span class="p">[</span><span class="s2">"LOCAL URL OR PART OF"</span><span class="p">],</span>
        <span class="s2">"stage"</span><span class="o">:</span> <span class="p">[</span><span class="s2">"STAGE URL OR PART OF"</span><span class="p">],</span>
        <span class="s2">"beta"</span><span class="o">:</span> <span class="p">[</span><span class="s2">"BETA URL OR PART OF"</span><span class="p">],</span>
        <span class="s2">"production"</span><span class="o">:</span> <span class="p">[</span><span class="s2">"PRODUCTION URL OR PART OF"</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">"facebook"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"ids"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"local"</span><span class="o">:</span> <span class="s2">"111111111111111"</span><span class="p">,</span>
            <span class="s2">"stage"</span><span class="o">:</span> <span class="s2">"222222222222222"</span><span class="p">,</span>
            <span class="s2">"beta"</span><span class="o">:</span> <span class="s2">"333333333333333"</span><span class="p">,</span>
            <span class="s2">"production"</span><span class="o">:</span> <span class="s2">"444444444444444"</span><span class="p">,</span>
            <span class="s2">"default"</span><span class="o">:</span> <span class="s2">"000000000000000"</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">"testsDir"</span><span class="o">:</span> <span class="s2">"/tests/tests/"</span><span class="p">,</span>
    <span class="s2">"globalTests"</span><span class="o">:</span> <span class="p">[</span>
        <span class="s2">"global/is_html_w3c_valid.js"</span><span class="p">,</span>
        <span class="s2">"global/has_utf8_metatag.js"</span><span class="p">,</span>
        <span class="s2">"global/has_facebook_appid.js"</span><span class="p">,</span>
        <span class="s2">"global/has_google_analytics.js"</span>
    <span class="p">],</span>
    <span class="s2">"pages"</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">"url"</span><span class="o">:</span> <span class="s2">"/tests/core/demo/index.html"</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">"url"</span><span class="o">:</span> <span class="s2">"/tests/core/demo/index.html?anotherPageUrl=1"</span><span class="p">,</span>
            <span class="s2">"tests"</span><span class="o">:</span> <span class="p">[</span> <span class="s2">"page/demo_page_test.js"</span> <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>

</pre></div>

<hr><h3>
<a name="optionsenvs---object" class="anchor" href="#optionsenvs---object"><span class="octicon octicon-link"></span></a>options.envs - Object</h3>

<p>This is where your environment is declared, you can specify on the config urls to be matched to a specific environment.</p>

<p>example:</p>

<div class="highlight"><pre>
    <span class="s2">"envs"</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s2">"production"</span><span class="o">:</span> <span class="p">[</span><span class="s2">"mywebsite.com"</span><span class="p">,</span> <span class="s2">"anotheralias"</span><span class="p">]</span>
    <span class="p">}</span>

</pre></div>

<p>if the string "**mywebsite.com**" or "**anotheralias**" is part of the website URL than that environment name will be returned by the <code>.env()</code> (in this case "**production**") method call from a test page. if no environment is found the string "**default**" will be returned.</p>

<p>You can setup as many environments as you wish, bear in mind that if a match is not found "**default**" will be returned.</p>

<hr><h3>
<a name="optionstestsdir---string" class="anchor" href="#optionstestsdir---string"><span class="octicon octicon-link"></span></a>options.testsDir - String</h3>

<p>This is the locations for MonkeytestJS <strong>based on the root of the website</strong>.</p>

<p>example: <strong><a href="http://mywebsite.com/tests/">http://mywebsite.com/tests/</a></strong></p>

<div class="highlight"><pre><span class="s2">"testsDir"</span><span class="o">:</span> <span class="s2">"tests"</span>

</pre></div>

<hr><h3>
<a name="optionsglobaltests---array" class="anchor" href="#optionsglobaltests---array"><span class="octicon octicon-link"></span></a>options.globalTests - Array</h3>

<p>Global tests are the tests that will be runned by all pages.</p>

<p>By default MonkeytestJS include 4 default tests:</p>

<pre><code> - is_html_w3c_valid ( checks if the page is valid throught the w3c validator )
 - has_utf8_metatag ( check for a presence of a utf8 metatag )
 - has_facebook_appid ( check for the facebookAPP id based on the environment )
 - has_google_analytics ( check if we have google analytics setup )
</code></pre>

<p><strong>Removing</strong> or <strong>adding</strong> a test is just a matter of deleting or adding a reference to it:</p>

<div class="highlight"><pre>    <span class="s2">"globalTests"</span><span class="o">:</span> <span class="p">[</span>
        <span class="s2">"global/is_html_w3c_valid.js"</span><span class="p">,</span>
        <span class="s2">"global/has_utf8_metatag.js"</span><span class="p">,</span>
        <span class="s2">"global/another_test_i_just_created.js"</span>
    <span class="p">]</span>
</pre></div>

<hr><h3>
<a name="optionspages---object" class="anchor" href="#optionspages---object"><span class="octicon octicon-link"></span></a>options.pages - Object</h3>

<p><strong>options.pages.url - String</strong></p>

<p>Url for the page to be tested, based on the root.</p>

<p>example:</p>

<div class="highlight"><pre>    <span class="s2">"url"</span><span class="o">:</span> <span class="s2">"/tests/core/demo/index.html"</span>
</pre></div>

<p><strong>options.pages.tests - Array</strong></p>

<p>Assign custom tests for the page. Custom tests will be runned on the page after the <strong>global tests</strong> have finished.</p>

<p><strong>Url for the tests are based on the <code>testsDir</code></strong></p>

<p>example:</p>

<div class="highlight"><pre>    <span class="s2">"tests"</span><span class="o">:</span> <span class="p">[</span>
        <span class="s2">"page/demo_page_test.js"</span>
    <span class="p">]</span>
</pre></div>

<h2>
<a name="monkeytestjs-api" class="anchor" href="#monkeytestjs-api"><span class="octicon octicon-link"></span></a>MonkeytestJS API</h2>

<p>This methods are used on the test page.</p>

<h3>
<a name="test-name-callback-" class="anchor" href="#test-name-callback-"><span class="octicon octicon-link"></span></a>test (name, callback ($){})</h3>

<p>Runs a synchronous QUint test.</p>

<h3>
<a name="asynctest-name-callback-" class="anchor" href="#asynctest-name-callback-"><span class="octicon octicon-link"></span></a>asyncTest (name, callback ($){})</h3>

<p>Runs an asynchronous QUint test. Must call this.asyncTestDone when the test is complete. Only then will the next chain
action be called.</p>

<h3>
<a name="asynctestdone-" class="anchor" href="#asynctestdone-"><span class="octicon octicon-link"></span></a>asyncTestDone ()</h3>

<p>This needs to be called when an <code>asyncTest()</code> finishes.</p>

<h3>
<a name="loadpage-urloptional" class="anchor" href="#loadpage-urloptional"><span class="octicon octicon-link"></span></a>loadPage (url[optional])</h3>

<p>Loads a page into the iframe, also waits until page is loaded before moving to the next action in the chain. If you are
performing tests on an actual page, this will normally be the first call in a test chain.</p>

<h3>
<a name="wait-function-timeout-throttle" class="anchor" href="#wait-function-timeout-throttle"><span class="octicon octicon-link"></span></a>wait (function, timeout, throttle)</h3>

<p>Waits for expression to be evaluated to true or timeout to happen, keeps checking for experssion on throttle interval.</p>

<h3>
<a name="env-" class="anchor" href="#env-"><span class="octicon octicon-link"></span></a>env ()</h3>

<p>Returns the current environment - based on the url of the current page. If not match is found it returns "default"</p>

<h3>
<a name="config-" class="anchor" href="#config-"><span class="octicon octicon-link"></span></a>config ()</h3>

<p>Returns the config object passed into MonkeytestJS.</p>

<p><strong>NOTE</strong></p>

<p><code>config()</code> and <code>env()</code> cant be used for chaining since they dont return <strong>context</strong>, they are meant to be used inside the
<code>test()</code> or <code>asyncTest()</code>.</p>

<h2>
<a name="writing-tests" class="anchor" href="#writing-tests"><span class="octicon octicon-link"></span></a>Writing Tests</h2>

<p>Add the path to the test script to either the options.globalTests[] array or for a specific page to the pages[].tests[]
array.</p>

<p>Create a test script file at the path entered above. At the most basic the test script should contain a call to the
registerTest (name, spec) function. Where the spec object literal must contain at least a function callback. An object can
be passed instead and an optional with a setup and load callback. The load callback is call in the scope of a MonkeytestJSPageTest object
which methods that should be chained together to to perform test actions (see <strong>MonkeytestJSPageTest</strong> methods above):</p>

<div class="highlight"><pre><span class="nx">registerTest</span> <span class="p">(</span><span class="s1">'Hello world test'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// this is the test script</span>
    <span class="k">this</span>
    <span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="s2">"Hello?"</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">ok</span><span class="p">(</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">"Hello world!"</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">);</span>
</pre></div>

<p>This can also be written as</p>

<div class="highlight"><pre><span class="nx">registerTest</span> <span class="p">(</span><span class="s1">'Hello world test'</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="nx">setup</span><span class="o">:</span><span class="kd">function</span> <span class="p">(</span><span class="nx">container</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// this is run before the test</span>
            <span class="c1">// use it to do things like clear cookies or assign helpers</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">myhelper</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">doSomething</span><span class="p">()</span> <span class="p">{};</span>
        <span class="p">}</span>
        <span class="p">,</span><span class="nx">load</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="c1">// this is the test script</span>
            <span class="k">this</span>
            <span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="s2">"Hello?"</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">)</span> <span class="p">{</span>

                <span class="kd">var</span> <span class="nx">env</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">env</span><span class="p">();</span> <span class="c1">// getting the environment</span>
                <span class="kd">var</span> <span class="nx">config</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">config</span><span class="p">();</span> <span class="c1">// getting the config</span>

                <span class="nx">ok</span><span class="p">(</span> <span class="nx">config</span><span class="p">.</span><span class="nx">foo</span><span class="p">[</span><span class="nx">env</span><span class="p">].</span><span class="nx">bar</span><span class="p">,</span> <span class="s2">"Accessing an item from config on a specific environment"</span> <span class="p">);</span>
                <span class="nx">ok</span><span class="p">(</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">"Hello world!"</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">);</span>
</pre></div>

<p>Refer to example test on: <code>./tests/page/demo_page_test.js</code></p>

<hr><h3>
<a name="contributors" class="anchor" href="#contributors"><span class="octicon octicon-link"></span></a>Contributors</h3>

<ul>
<li>Kynan Stewart Hughes - <a href="https://github.com/k7n4n5t3w4rt" class="user-mention">@k7n4n5t3w4rt</a>
</li>
<li>Thomas Garrood - <a href="https://github.com/sandboxdigital" class="user-mention">@sandboxdigital</a>
</li>
<li>Mitermayer Reis - <a href="https://github.com/mitermayer" class="user-mention">@mitermayer</a>
</li>
<li>Peter Feltham  - <a href="https://github.com/felthy" class="user-mention">@felthy</a>
</li>
</ul><p><strong>Change log</strong></p>

<ul>
<li>
<strong>1.0.0</strong> - Initial release.</li>
</ul>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>